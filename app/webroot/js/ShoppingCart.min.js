(function(){"use strict";if(undefined===window.AcidJs){window.AcidJs={}}function Console(a,b){b=b||{};this.superclass=a||{};for(var p in b){if(typeof this[p]!=="undefined"){this[p]=b[p]}}}Console.prototype={MANIFEST:{version:"1.0",name:"Console",developer:"Martin Ivanov",websites:{page:"http://acidjs.wemakesites.net/",personal:"http://wemakesites.net",portfolio:"http://acidjs.wemakesites.net",blog:"http://acidmartin.wordpress.com/",rss:"http://feeds.feedburner.com/acidmartin",twitter:"https://twitter.com/#!/wemakesitesnet"},email:"acid_martin@yahoo.com"},log:function(){if(!this.superclass.debug){return}if(window.console&&typeof window.console.log==="function"){try{window.console.log.apply(window.console,arguments)}catch(err){}}},error:function(){if(!this.superclass.debug){return}if(window.console&&typeof window.console.error==="function"){try{window.console.error.apply(window.console,arguments)}catch(err){}}else{this.log.apply(this,arguments)}},warn:function(){if(!this.superclass.debug){return}if(window.console&&typeof window.console.warn!=="function"){try{window.console.warn.apply(window.console,arguments)}catch(err){}}else{this.log.apply(this,arguments)}}};window.AcidJs.Console=Console})();(function(){"use strict";if(undefined===window.AcidJs){window.AcidJs={}}function Utils(){}Utils.prototype={MANIFEST:{version:"1.0",name:"Utilities",developer:"Martin Ivanov",websites:{page:"http://acidjs.wemakesites.net/",personal:"http://wemakesites.net",portfolio:"http://acidjs.wemakesites.net",blog:"http://acidmartin.wordpress.com/",rss:"http://feeds.feedburner.com/acidmartin",twitter:"https://twitter.com/#!/wemakesitesnet"},email:"acid_martin@yahoo.com"},REGEXES:{uuid:/[xy]/g},compileLocalTemplate:function(a,b){a=a||"";b=b||{};for(var c in b){if(b.hasOwnProperty(c)){var d=b[c],regexp=new RegExp("{{"+c+"}}","g");a=a.replace(regexp,d)}}return a},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(this.REGEXES.uuid,function(c){var r=window.Math.random()*16|0,v=c==="x"?r:(r&0x3|0x8);return v.toString(16)})},stringToJson:function(a){if(a){return $.parseJSON(a)}},jsonToString:function(a){if(a){return window.JSON.stringify(a)}},later:function(a,b){if(!a||!b){return}window.setTimeout(function(){a.call(this)},b)},encodeURIComponent:function(a){if(a){return window.encodeURIComponent(a)}},getURL:function(a){if(typeof a!=="object"){a=window.JSON.parse(a)}var b=a.url,target=a.target||"_self",features=a.features||"";window.open(b,target,features)},disable:function(a){$.each(a,function(i){$('[name="'+a[i]+'"]').attr("disabled","disabled")})},enable:function(a){$.each(a,function(i){$('[name="'+a[i]+'"]').removeAttr("disabled")})},getInstancesOf:function(a,b){"use strict";var c=[];if(!window.hasOwnProperty){return}for(var v in b){if(b.hasOwnProperty(v)&&b[v]instanceof a){c.push(v)}}return c}};window.AcidJs.Utils=Utils})();(function(){"use strict";if(undefined===window.AcidJs){window.AcidJs={}}function Cookies(a){this.superclass=a;this.testcookie="__site_testcookie__"}Cookies.prototype={MANIFEST:{version:"1.0",name:"Cookies",developer:"Martin Ivanov",websites:{page:"http://acidjs.wemakesites.net/",personal:"http://wemakesites.net",portfolio:"http://acidjs.wemakesites.net",blog:"http://acidmartin.wordpress.com/",rss:"http://feeds.feedburner.com/acidmartin",twitter:"https://twitter.com/#!/wemakesitesnet"},email:"acid_martin@yahoo.com"},create:function(a){var b="",name=a.name,value=a.value,days=a.days,path=a.path;if(days){var c=new Date();c.setTime(c.getTime()+(days*24*60*60*1000));b="; expires="+c.toGMTString()}else{b=""}window.document.cookie=name+"="+value+b+"; path="+path},read:function(a){var n=a.name,nameeq=n+"=",ca=window.document.cookie.split(";");for(var i=0,len=ca.length;i<len;i++){var c=ca[i];while(c.charAt(0)==" "){c=c.substring(1,c.length)}if(c.indexOf(nameeq)==0){return c.substring(nameeq.length,c.length)}}return null},erase:function(a){this.create({name:a.name,value:"",days:-1,path:a.path})},enabled:function(){var a=(window.navigator.enabled)?true:false,testcookie=this.testcookie;if(typeof window.navigator.enabled=="undefined"&&!a){window.document.cookie=testcookie;a=(window.document.cookie.indexOf(testcookie)!=-1)?true:false}return(a)},exists:function(a){if(null!==this.read({name:a.name})){return true}return false}};window.AcidJs.Cookies=Cookies})();(function(){"use strict";if(undefined===window.AcidJs){window.AcidJs={}}function Sysnotice(a){this.superclass=a||{};this.hidetimeout=null;this.bind()}var c=$("body"),NOTICE_DEFAULT_WIDTH=400,NOTICE_HIDE_SPEED=500,NOTICE_CLOSE_DELAY=5000;Sysnotice.prototype={bind:function(){var a=this;c.delegate(".acidjs-sysnotice","click",function(){a.hide()})},show:function(a){var b=a.type||"info",text=a.text||"",width=a.width||NOTICE_DEFAULT_WIDTH,selfclose=a.selfClose||a.selfClose===undefined?true:false,superclass=this.superclass,that=this,style=[];this._clearTimeout();this._getSysnoticeNode().remove();style.push("width:"+width+"px","margin-left:"+width/2*-1+"px");c.append(superclass.tm.compile("sysnotice",{type:b,text:text,style:style.join(";")}));if(!selfclose){return}this.hidetimeout=window.setTimeout(function(){that.hide()},NOTICE_CLOSE_DELAY)},hide:function(){var a=this._getSysnoticeNode();this._clearTimeout();a.fadeOut(NOTICE_HIDE_SPEED,function(){a.remove()})},_getSysnoticeNode:function(){return $(".acidjs-sysnotice")},_clearTimeout:function(){window.clearTimeout(this.hidetimeout);this.hidetimeout=null},destroy:function(){this._clearTimeout();this._getSysnoticeNode().remove()}};window.AcidJs.Sysnotice=Sysnotice})();(function(){"use strict";if(undefined===window.AcidJs){window.AcidJs={}}function Spinbox(){this.bound=false;if(!this.bound){this.bind()}this.lessThanIe10=this.ie()<10}var g=$("body");Spinbox.prototype={MANIFEST:{version:"1.0",name:"HTML5 Input Number Polyfill",developer:"Martin Ivanov",websites:{page:"http://acidjs.wemakesites.net/",personal:"http://wemakesites.net",portfolio:"http://acidjs.wemakesites.net",blog:"http://acidmartin.wordpress.com/",rss:"http://feeds.feedburner.com/acidmartin",twitter:"https://twitter.com/#!/wemakesitesnet"},email:"acid_martin@yahoo.com"},CSS_CLASSES:{base:"acidjs-spinbox",disabled:"acidjs-spinbox-disabled"},CSS_BOOTSTRAP:[],TEMPLATES:{base:'<span class="acidjs-spinbox"><span class="acidjs-spinbox-inner-wrapper"><!-- / --></span></span>',controls:'<span class="acidjs-spinbox-controls"><button class="acidjs-spinbox-arrow acidjs-spinbox-arrow-up" name="up"><b><!-- / --></b></button><button class="acidjs-spinbox-arrow acidjs-spinbox-arrow-down" name="down"><b><!-- / --></b></button></span>'},enable:function(){if(this.ie()<6){return}if(!window.chrome){this.render()}},ie:function(){var a,v=3,div=document.createElement('div'),all=div.getElementsByTagName('i');while(div.innerHTML='<!--[if gt IE '+(++v)+']><i></i><![endif]-->',all[0]);return v>4?v:a},createInputDto:function(a,b,c,d,e){var f={step:a||1,min:b,max:c,direction:d,value:e||0};return f},bind:function(){var b=this,classes=this.CSS_CLASSES;g.delegate(".acidjs-spinbox-arrow","click",function(){var a=$(this),direction=a.attr("name"),boundingBox=a.parents("."+classes.base),input=boundingBox.find("input"),data=b.createInputDto(input.attr("step"),input.attr("min"),input.attr("max"),direction,input.val());b.spin(input,data)});g.delegate("."+classes.base+" input","keydown",function(e){var a=$(this),direction,data;if(!a.is(":focus")){return}switch(e.which){case 38:direction="up";break;case 40:direction="down";break}data=b.createInputDto(a.attr("step"),a.attr("min"),a.attr("max"),direction,a.val());b.spin(a,data)});this.bound=true},spin:function(a,b){var c=a.val(),value=window.parseFloat(b.value,10),max=b.max,min=b.min,tempValue,step=window.parseFloat(b.step,10);switch(b.direction){case"up":tempValue=value+step;if(tempValue<=max||!max){c=tempValue}break;case"down":tempValue=value-step;if(tempValue>=min||!min){c=tempValue}break}a.val(c);a.trigger("change")},render:function(){var b=this,templates=this.TEMPLATES,classes=this.CSS_CLASSES,type=this.lessThanIe10?"data-type":"type",inputs=$('input['+type+'="number"]');inputs.each(function(){var a=$(this);if(a.hasClass(classes.base)){return}a.wrap(templates.base);a.parents("."+classes.base+" > span").append(templates.controls);if(b.ie()<10&&a.attr("disabled")){a.parents("."+classes.base).addClass(classes.disabled).find("button").attr("disabled","disabled")}})}};window.AcidJs.Spinbox=Spinbox})();(function(){"use strict";if(undefined===window.AcidJs){window.AcidJs={}}function DataManager(a){this.data={};if(a){a()}}DataManager.prototype={ATTRS:{delimiter:"."},create:function(a,b){this.data[a]={};if(b){b()}},store:function(a,b,c,d){if(!a||!b||!c){return}if(this.data[a]){this.data[a][b]=c}if(d){d()}},retrieve:function(e){var f=this.data,delimiter=this.ATTRS.delimiter,_recurse=function(a,b){var c=b.split(delimiter),newObj=a[c[0]];if(c[1]){c.splice(0,1);var d=c.join(delimiter);return _recurse(newObj,d)}return newObj};if(!e){return this.data}return _recurse(f,e)},remove:function(d,e){var f=this.data,delimiter=this.ATTRS.delimiter,parts=d.split(delimiter),_recurse=function(a){if(undefined===a){return}var b=a[parts[0]];if(parts[1]){parts.splice(0,1);var c=parts.join(delimiter);if(parts.length>1){_recurse.call(this,b)}else{delete b[c];if(e){e()}}}};if(d.split(delimiter).length===1){delete f[d];if(e){e()}return}_recurse.call(this,f)}};window.AcidJs.DataManager=DataManager})();(function(){"use strict";if(undefined===window.AcidJs){window.AcidJs={}}function Renderer(){}Renderer.prototype={TEMPLATES:{},compile:function(a,b){var c=this.TEMPLATES[a]||"";b=b||{};for(var d in b){if(b.hasOwnProperty(d)){var e=b[d],regexp=new RegExp("{{"+d+"}}","g");c=c.replace(regexp,e)}}return c},add:function(a,b,c){if(a&&b){this.TEMPLATES[a]=b;if(c){c.call(this)}}},remove:function(a){if(this.TEMPLATES[a]){delete this.TEMPLATES[a]}}};window.AcidJs.Renderer=Renderer})();(function(){"use strict";if(undefined===window.AcidJs){window.AcidJs={}}function ShoppingCart(c){var d,messages=this.SYSTEM_MESSAGES;this.boundingBox=$(".acidjs-shopping-cart");this.cartDropdown=$(".acidjs-shopping-cart-dropdown");this.tm=new window.AcidJs.Renderer();d=this.tm;$.each(this.INTERNAL_TEMPLATES,function(a,b){d.add(a,b)});this.utils=new window.AcidJs.Utils();if(!c){this.error("missingConfig");return}if(document.compatMode==="BackCompat"){alert(messages.errorTitle+'\n\n'+messages.compatMode);return}if(!this.boundingBox.length){alert(messages.errorTitle+'\n\n'+messages.missingBoundingBox);return}if(!this.cartDropdown.length){alert(messages.errorTitle+'\n\n'+messages.missingCartDropdown);return}if(window.hasOwnProperty){if(this.utils.getInstancesOf(window.AcidJs.ShoppingCart,window).length>0){alert(messages.errorTitle+'\n\n'+messages.moreThanOneInstance);return}}for(var e in c){if(c.hasOwnProperty(e)){this[e]=c[e]}}this.returnedFromPaymentProvider=false;this.appRoot="";this.cssRoot="styles/";this.classesRoot="";this.imagesRoot="images/";this.templatesExtension=".html";this.langRoot="/files/lang/";this.checkout={};this.cookie={};this.console=new window.AcidJs.Console(this);this.dm=new window.AcidJs.DataManager();this.spinner=new window.AcidJs.Spinbox();this.cookies=new window.AcidJs.Cookies(this);this.notices=new window.AcidJs.Sysnotice(this);if(this.mode==="cart"){this.boundingBox.addClass(this.CSS_CLASSES.modeCart)}this.init();this.bind()}var f=$(window),BODY=$("body");ShoppingCart.prototype={INTERNAL_TEMPLATES:{error:'<div class="acidjs-shopping-cart-error"><h6>{{title}}</h6><p>{{error}}</p></div>',info:'<div class="acidjs-shopping-cart-info">{{text}}</div>',credits:'<div class="acidjs-shopping-cart-credits">Powered by <a title="Visit {{url}}" href="{{url}}" target="_blank">{{name}}</a></div>'},colors:["f4b300","78ba00","2673ec","ae113d","632f00","b01e00","7200ac","4617b4","006ac1","008287","199900","00c13f","ff981d","ff2e12","ff1d77","aa40ff","1faeff","56c5ff","00d8cc","91d100","e1b700","ff76bc","00a4a4","ff7d23","252525","2e1700","4e0000","4e0038","2d004e","1f0068","001e4e","004d60","004a00","15992a","e56c19","b81b1b","1b58b8","569ce3","00aaaa","696969","83ba1f","d39d09","e064b7"],debug:false,MANIFEST:{version:"1.0",name:"HTML5 Shopping Cart",download:"http://html5-cart.com/",developer:"Martin Ivanov",websites:{page:"http://html5-cart.com/",personal:"http://wemakesites.net",portfolio:"http://acidjs.wemakesites.net",blog:"http://acidmartin.wordpress.com/",rss:"http://feeds.feedburner.com/acidmartin",twitter:"https://twitter.com/#!/wemakesitesnet"},email:"acid_martin@yahoo.com"},ATTRS:{readOnly:'readonly="readonly"',disabled:'disabled="disabled"',cartDefaultQuantity:'data-cart-default-quantity'},currency:"USD",CURRENCY_CODES:{usd:"&#36;",gbp:"&#163;",yen:"&#165;",eur:"&#128;"},COOKIES:{base:"__acidjs_shopping_cart__"},SYSTEM_MESSAGES:{errorTitle:'Cannot Initialize Shopping Cart Because of an Error:',compatMode:'The page on which HTML5 Cart resides is in quirks mode and the control won\'t initialize, because it requires standards-compliant pages.\n\nPlease, make sure that the doctype of the pages where you install the component is HTML5, XHTML1.0, XHTML1.1 or that you are using a skinny doctype.',moreThanOneInstance:'You are trying to instantiate more than one instance of the window.AcidJs.ShoppingCart object. You cannot have more than one running istance of this object on a single page.',missingCartDropdown:'Cannot initialize your shopping cart, because of missing cart dropdown element. Please, add <div class="acidjs-shopping-cart-dropdown"></div> element to the DOM of your page, which will be used to render the items which are currently added to the cart.',missingBoundingBox:'Cannot initialize your shopping cart, because of missing bounding box element. Please, add <div class="acidjs-shopping-cart"></div> element to the DOM of your page, which will be used to render your items.',langKeyNotFound:'[error] The requtested language key "<strong>{{key}}</strong>" not found. Check your language file.',missingCartDataFile:'Missing shopping cart data file. Check the <code>cartDataFile</code> property in the shopping card configuration and make sure that the file exists on your server.',missingCartLanguageFile:'Missing cart language file. Check the <code>lang</code> property in the shopping card configuration and make sure that the file <code>AcidJs.ShoppingCart/lang/<strong>[lang-code]</strong>.json</code> exists on your server.',missingConfig:'Missing configuration declaration. Please, check the documentation and add propert shopping cart configuration.',thumbDimensionsIsNan:'The value of <code>width</code> and <code>height</code> of the thumbnails should be a number. Check the <code>thumbs</code> property in the configuration object.',thumbsLessThanSupported:'The value <code>width</code> and the <code>height</code> of the thumbnails should be a number equal to or bigger than <code>128</code> pixels. Check the <code>thumbs</code> property in the config object.',itemMissingName:'An item in your shopping cart data file is missing <code>name</code>.',itemMissingPrice:'An item in your shopping cart data file is missing <code>price</code>.',itemMissingId:'An item in your shopping cart data file is missing <code>id</code>. To create an <code>id</code> for an item, you can type <code>window.AcidJs.Utils.prototype.uuid()</code> and then set the resulting UUID as <code>id</code> to that item.'},TEMPLATES:["item","items","cart.dropdown","sysnotice"],lang:"en-us",thumbs:{width:256,height:256},CSS_CLASSES:{base:"acidjs-shopping-cart",added:"acidjs-shopping-cart-item-added",dropdownList:"acidjs-shopping-cart-dropdown-list",item:"acidjs-shopping-cart-item",modeCart:"acidjs-shopping-cart-mode-cart",addToCartButton:"acidjs-add-to-cart",dropdownHidden:"acidjs-shopping-cart-dropdown-hidden",checkingOut:"acidjs-shopping-cart-checking-out"},EVENTS:["acidjs-shopping-cart-templates-loaded","acidjs-shopping-cart-config-loaded","acidjs-shopping-cart-payment-provider-loaded","acidjs-shopping-cart-payment-provider-ready","acidjs-shopping-cart-updated","acidjs-shopping-cart-return-from-payment-provider","acidjs-shopping-cart-ready","acidjs-shopping-cart-before-checkout","acidjs-shopping-cart-after-checkout-success","acidjs-shopping-cart-after-checkout-cancel","acidjs-shopping-cart-after-item-added","acidjs-shopping-cart-after-item-removed"],URLS:{templates:"/files/templates/",paymentProvider:"/js/ShoppingCart.PaymentProviderService.{{paymentProvider}}.js",config:"config.json",replacement:"placeholder.png"},mode:"cart",daysToStoreCartDataInCookie:1,init:function(){var c=this.tm,events=this.EVENTS,extension=this.templatesExtension,templatesUrl=/*this.appRoot+*/this.URLS.templates,templates=this.TEMPLATES,i=0,length=templates.length,_getTemplate=function(){var b=templates[i],url=templatesUrl+b+extension;$.ajax({url:url,cache:false,success:function(a){c.add(b,a);i++;if(length===i){f.trigger(events[0])}else{_getTemplate.call(this,i)}}})};_getTemplate.call(this,i)},bind:function(){var d=this,console=this.console,classes=this.CSS_CLASSES,bBox=this.boundingBox,utils=this.utils,notices=this.notices,cartDropdown=this.cartDropdown,events=this.EVENTS;$.each(events,function(i){var c=events[i];f.bind(c,function(e,a){console.log("[EVENT]",e.type,a);switch(e.type){case events[0]:d.getCartConfig();break;case events[1]:d.getPaymentProvider();break;case events[2]:d.checkout=new window.AcidJs.ShoppingCart.PaymentProviderService(d,a.paymentProvider);d.checkout.done();break;case events[3]:if(d.returnedFromPaymentProvider){var b=d.cartDataCookieName,cookieNameObj={};cookieNameObj[b]=[];d.dm.store("cart","checkout",cookieNameObj[b]);d.cookies.create({name:d.COOKIES.base+d.cartDataCookieName,value:utils.jsonToString(cookieNameObj),path:"/"})}d.render();break;case events[4]:d.onCartUpdated();break}})});bBox.delegate('.acidjs-shopping-cart-items button[name="add-to-cart"]',"click",function(){var a=$(this).parents("."+classes.item),index=d.utils.stringToJson(a.attr("data-bind"));if(!a.hasClass(classes.added)){a.addClass(classes.added);d.addTocart(a,index.index)}});bBox.delegate('.acidjs-shopping-cart-item-name a[href="#"]',"click",function(e){e.preventDefault()});cartDropdown.delegate('.acidjs-shopping-cart-item-name a[href="#"]',"click",function(e){e.preventDefault()});cartDropdown.delegate("h4","click",function(e){e.stopPropagation();d.showCartDropdown()});cartDropdown.delegate("input","change",function(){d.updateCart()});BODY.bind("click",function(e){if($(e.target).closest("."+classes.dropdownList).length===0){d.hideCartDropdown()}});cartDropdown.delegate("button","click",function(e){var a=$(this),name=a.attr("name");switch(name){case"remove-from-cart":var b=a.parents("."+classes.item),id=b.attr("data-id"),index=b.index();e.stopPropagation();d.removeFromCart(b,index,id);break;case"update-cart":d.updateCart();break;case"go-to-checkout":cartDropdown.addClass(classes.checkingOut);f.trigger(events[7],d.dm.retrieve("cart.items"));d.checkout.submit();d.utils.disable(["go-to-checkout","update-cart"]);break}});BODY.delegate("."+classes.addToCartButton,"click",function(){var a=$(this),itemId=a.attr("data-item-id"),utils=d.utils,items=d.dm.retrieve("cart.items"),itemInList=bBox.find('li[data-id="'+itemId+'"]'),index=utils.stringToJson(itemInList.attr("data-bind"));if(itemInList.hasClass(classes.added)){notices.show({text:utils.compileLocalTemplate(d.getLangKey("alreadyInCart"),{name:items[index.index].name})})}else{itemInList.addClass(classes.added);d.addTocart(itemInList,index.index);a.attr("disabled","disabled")}})},hideCartDropdown:function(){var a=this.cartDropdown,classes=this.CSS_CLASSES;a.find("."+classes.dropdownList).addClass(classes.dropdownHidden)},showCartDropdown:function(){var a=this.cartDropdown,classes=this.CSS_CLASSES;this.utils.later(function(){a.find("."+classes.dropdownList).removeClass(classes.dropdownHidden)},10)},getLangKey:function(a){var b=this.dm.retrieve("cart.lang");return b[a]||this.utils.compileLocalTemplate(this.SYSTEM_MESSAGES.langKeyNotFound,{key:a})},updateCart:function(){var b=this.dm,classes=this.CSS_CLASSES,cartDropdown=this.cartDropdown,checkoutData=b.retrieve("cart.checkout");cartDropdown.find("."+classes.item).each(function(){var a=$(this),quantity=a.find('input[name="quantity"]').val(),index=a.index();checkoutData[index].quantity=quantity});b.store("cart.checkout",checkoutData);f.trigger(this.EVENTS[4],b.retrieve("cart.checkout"))},removeFromCart:function(a,b,c){var d=this.dm,bBox=this.boundingBox,classes=this.CSS_CLASSES,attrs=this.ATTRS,listItem='li[data-id="'+c+'"]',addToCartButton='button[data-item-id="'+c+'"]',spinner=bBox.find(listItem).find('input'),checkoutData=d.retrieve("cart.checkout");a.remove();bBox.find(listItem).removeClass(classes.added);BODY.find(addToCartButton).removeAttr("disabled");spinner.val(spinner.attr(attrs.cartDefaultQuantity));checkoutData.splice(b,1);d.store("cart.checkout",checkoutData);this.notices.show({text:this.getLangKey("itemRemovedFromCart")});f.trigger(this.EVENTS[4],d.retrieve("cart.checkout"));f.trigger(this.EVENTS[11],d.retrieve("cart.items")[b])},onCartUpdated:function(){var b=this.dm,cartDropdown=this.cartDropdown,cartDropdownCountElement=cartDropdown.find("h4 strong"),itemsElement=cartDropdown.find("h4"),classes=this.CSS_CLASSES,total=0,utils=this.utils,drodownControls=["update-cart","go-to-checkout"],totalElement=cartDropdown.find("h5 strong"),checkoutData=b.retrieve("cart.checkout"),itemsNoun,checkoutDatalength=checkoutData.length;cartDropdownCountElement.html(checkoutDatalength);if(0===checkoutDatalength||1<checkoutDatalength){itemsNoun=this.getLangKey("labelItemPlural")}else{itemsNoun=this.getLangKey("labelItemSingular")}itemsElement.attr("title",checkoutDatalength+" "+itemsNoun);cartDropdown.find("."+classes.item).each(function(){var a=$(this),index=a.index(),quantityInput=a.find('input[name="quantity"]'),price=checkoutData[index].price;total=window.parseFloat(total,10)+(window.parseFloat(price*quantityInput.val(),10))});totalElement.html(total.toFixed(2));if(0===checkoutDatalength){utils.disable(drodownControls)}else{utils.enable(drodownControls)}this.updateCookieData()},updateCookieData:function(){var a=this.dm,cookies=this.cookies,utils=this.utils,cookieBaseName=this.COOKIES.base+this.cartDataCookieName,cookieData=utils.stringToJson(cookies.read({name:cookieBaseName})),checkoutData=a.retrieve("cart.checkout");if(!cookies.enabled()){return}cookieData[this.cartDataCookieName]=checkoutData;cookies.create({name:cookieBaseName,value:utils.jsonToString(cookieData),days:this.daysToStoreCartDataInCookie,path:"/"})},addTocart:function(a,b){var c=this.dm,classes=this.CSS_CLASSES,dropdown=this.cartDropdown,list=dropdown.find(".acidjs-shopping-cart-dropdown-list > ul"),itemsData=c.retrieve("cart.items")[b],checkoutData=c.retrieve("cart.checkout");itemsData.quantity=a.find('input[name="quantity"]').val();a.clone().appendTo(dropdown.find("."+classes.dropdownList+" > ul"));checkoutData.push(itemsData);c.store("cart.checkout",checkoutData);this.notices.show({text:this.getLangKey("itemAddedToCart")});f.trigger(this.EVENTS[4],c.retrieve("cart.checkout"));this.showCartDropdown();list.scrollTop(list.get(0).scrollHeight);this.utils.later(function(){dropdown.find("li:last-child").removeClass(classes.added)},500);f.trigger(this.EVENTS[10],c.retrieve("cart.items")[b])},render:function(){var b=this.dm,tm=this.tm,that=this,urls=this.URLS,manifest=this.MANIFEST,cartDropdown=this.cartDropdown,appRoot=this.appRoot,imagesRoot=this.imagesRoot,urlThumbPlaceholder=appRoot+imagesRoot+urls.replacement,thumbs=this.thumbs,attrs=this.ATTRS,disabled=attrs.disabled,bBox=this.boundingBox,items=b.retrieve("cart.items"),currency_code=this.currency,currency_symbol=this.CURRENCY_CODES[currency_code.toLowerCase()]||"",itemsHtml=[],_error=function(a){this.error(a)},_cokiesDisabled=function(){return tm.compile("info",{text:this.getLangKey("cookiesAreDisabled")})};if(window.isNaN(thumbs.width)||window.isNaN(thumbs.height)){_error.call(this,"thumbDimensionsIsNan");return}if(thumbs.width<128||thumbs.height<128){_error.call(this,"thumbsLessThanSupported");return}$.each(items,function(i){var a=items[i],templateData={name:a.name,quantity:a.quantity||1,price:a.price,uuid:a.id,url:a.url||"#",description:a.description||"",currency_code:currency_code,currency_symbol:currency_symbol,i:i,thumb:a.thumb?a.thumb:urlThumbPlaceholder,width:thumbs.width,height:thumbs.height,titleWidth:thumbs.width-48,allowChangeQuantity:a.allowChangeQuantity?"":disabled};if(undefined===a.name||""===a.name){items.length=0;_error.call(that,"itemMissingName")}if(undefined===a.price||""===a.price){items.length=0;_error.call(that,"itemMissingPrice")}if(undefined===a.id||""===a.id){items.length=0;_error.call(that,"itemMissingId")}itemsHtml.push(that.renderCartItem(templateData))});itemsHtml=itemsHtml.join("");bBox.html(tm.compile("items",{itemsHtml:itemsHtml}));cartDropdown.html(tm.compile("cart.dropdown",{currency_code:currency_code,currency_symbol:currency_symbol,labelUpdateCart:this.getLangKey("labelUpdateCart"),labelGoToCheckout:this.getLangKey("labelGoToCheckout"),paymentProvider:this.utils.compileLocalTemplate(this.getLangKey("contactingPaymentProvider"),{paymentProvider:this.paymentProvider})}));this.spinner.enable();cartDropdown.find("."+this.CSS_CLASSES.dropdownList).append(tm.compile("credits",{url:manifest.websites.page,name:manifest.name}));f.trigger(this.EVENTS[4],b.retrieve("cart.checkout"));if(!this.cookies.enabled()){bBox.find("> div").prepend(_cokiesDisabled.call(this));cartDropdown.find("."+this.CSS_CLASSES.dropdownList).prepend(_cokiesDisabled.call(this))}if(undefined!==this.getIEVersion()){BODY.addClass("acidjs-shopping-cart-ie-"+this.getIEVersion())}this.getStoredCookieDataAndRenderIt()},getStoredCookieDataAndRenderIt:function(){var b=this,cookies=this.cookies,utils=this.utils,list=this.boundingBox.find(".acidjs-shopping-cart-items"),dropdown=this.cartDropdown,classes=this.CSS_CLASSES,checkoutData,cookieBaseName=this.COOKIES.base+this.cartDataCookieName;if(cookies.exists({name:cookieBaseName})){checkoutData=utils.stringToJson(cookies.read({name:cookieBaseName}));checkoutData=checkoutData[b.cartDataCookieName];$.each(checkoutData,function(i){var a=checkoutData[i],id=a.id,listItem=list.find('li[data-id="'+id+'"]');listItem.find('input[name="quantity"]').val(a.quantity);listItem.clone().appendTo(dropdown.find("."+classes.dropdownList+" > ul"));listItem.addClass(classes.added);BODY.find('button[data-item-id="'+id+'"]').attr("disabled","disable")});f.trigger(this.EVENTS[4],this.dm.retrieve("cart.checkout"))}f.trigger(this.EVENTS[6])},renderCartItem:function(a){var b=this.colors;a.labelAddToCart=this.getLangKey("labelAddToCart");a.labelAddedToCart=this.getLangKey("labelAddedToCart");a.labelRemoveFromCart=this.getLangKey("labelRemoveFromCart");a.labelChangeQuantity=this.getLangKey("labelChangeQuantity");a.labelUnitPrice=this.getLangKey("labelUnitPrice");a.readonly=window.chrome?"":this.ATTRS.readOnly;a.color="#"+b[window.Math.floor(window.Math.random()*b.length)];return this.tm.compile("item",a)},getPaymentProvider:function(){var a=this.paymentProvider,url=this.appRoot+this.classesRoot+this.URLS.paymentProvider,events=this.EVENTS;$.ajax({cache:false,url:this.utils.compileLocalTemplate(url,{paymentProvider:a}),dataType:"script",success:function(){f.trigger(events[2],{paymentProvider:a})}})},getCartConfig:function(){var c=this.dm,that=this,cookies=this.cookies,utils=this.utils,cookieBaseName=this.COOKIES.base,events=this.EVENTS,checkoutData,langUrl=/*this.appRoot+*/this.langRoot+this.lang+".json",cookieData={},url=this.cartDataFile;this.cartDataCookieName=url.split("/").pop().split(".")[0];cookieBaseName=cookieBaseName+this.cartDataCookieName;$.ajax({dataType:"json",url:url,cache:false,error:function(){this.error("missingCartDataFile");return},success:function(b){$.ajax({dataType:"json",url:langUrl,cache:false,error:function(){that.error("missingCartLanguageFile");return},success:function(a){if(cookies.exists({name:cookieBaseName})){checkoutData=utils.stringToJson(cookies.read({name:cookieBaseName}));checkoutData=checkoutData[that.cartDataCookieName]}else{checkoutData=[]}c.create("cart",function(){c.store("cart","lang",a.lang);c.store("cart","items",b.items);c.store("cart","checkout",checkoutData)});cookieData[that.cartDataCookieName]=c.retrieve("cart.checkout");cookies.create({name:cookieBaseName,value:utils.jsonToString(cookieData),days:that.daysToStoreCartDataInCookie,path:"/"});f.trigger(events[1],that.dm.retrieve("cart.items"))}})}})},error:function(a){var b=this.SYSTEM_MESSAGES;this.boundingBox.removeClass(this.CSS_CLASSES.modeCart).html(this.tm.compile("error",{error:b[a],title:b.errorTitle}))},getIEVersion:function(){var a,v=3,div=document.createElement("div"),all=div.getElementsByTagName("i");while(div.innerHTML="<!--[if gt IE "+(++v)+"]><i></i><![endif]-->",all[0]);return v>4?v:a}};window.AcidJs.ShoppingCart=ShoppingCart})();